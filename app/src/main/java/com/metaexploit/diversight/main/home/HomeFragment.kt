package com.metaexploit.diversight.main.home

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.databinding.DataBindingUtil
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.google.android.material.button.MaterialButton
import com.metaexploit.diversight.R
import com.metaexploit.diversight.ResearchAdapter
import com.metaexploit.diversight.databinding.FragmentHomeBinding

class HomeFragment : Fragment() {

    // Data binding
    private lateinit var binding: FragmentHomeBinding
    // Filter list reference
    private lateinit var listFilter: List<MaterialButton>
    // Research list reference
    private lateinit var listResearch: List<RecyclerView>
    // Adapters
    private val dailyResearchAdapter: ResearchAdapter by lazy { ResearchAdapter() }
    private val weeklyResearchAdapter: ResearchAdapter by lazy { ResearchAdapter() }
    private val npsResearchAdapter: ResearchAdapter by lazy { ResearchAdapter() }
    private val admDemResearchAdapter: ResearchAdapter by lazy { ResearchAdapter() }

    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        // Inflate the layout for this fragment
        binding = DataBindingUtil.inflate(inflater, R.layout.fragment_home, container, false)
        return binding.root
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        // Get references
        listFilter = listOf(binding.btnFilterDaily, binding.btnFilterWeekly, binding.btnFilterNps)
//        listResearch = listOf(binding.listDaily, binding.listWeekly, binding.listNps, binding.listAdmDem)

        // Set setFilterFunction in filter list
        for (filter in listFilter) {
            filter.setOnClickListener { setFilterFunction(it.id) }
        }

        // Set adapter in research list
//        for (research in listResearch) {
//            research.adapter = researchAdapter
//        }

        binding.listDaily.adapter = dailyResearchAdapter
        dailyResearchAdapter.setList(listOf("a", "b", "c"))
        binding.listWeekly.adapter = weeklyResearchAdapter
        weeklyResearchAdapter.setList(listOf("d", "e", "f"))
        binding.listNps.adapter = npsResearchAdapter
        npsResearchAdapter.setList(listOf("g", "h", "i"))
        binding.listAdmDem.adapter = admDemResearchAdapter
        admDemResearchAdapter.setList(listOf("j", "k", "l"))

    }
    
    // Disable other filters when clicked
    private fun setFilterFunction(selected: Int) {
        for (filter in listFilter) {
            if (filter.id != selected) {
                filter.isChecked = false
            }
        }
    }
}